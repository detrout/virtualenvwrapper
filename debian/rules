#!/usr/bin/make -f

override_dh_auto_clean:
	rm -rf build
	find -name '._*' -delete

override_dh_auto_install:
	for lang in en es ja; do \
		sphinx-build -b html -a -E -N -C -A project=virtualenvwrapper \
		   -D language=$$lang -D master_doc=index \
		   docs/$$lang debian/virtualenvwrapper/usr/share/doc/virtualenvwrapper/$$lang/html; \
	done
	for lang in es ja; do \
		currentdir=$$(pwd); \
		cd debian/virtualenvwrapper/usr/share/doc/virtualenvwrapper/$$lang/html; \
		rm -rf _static; \
		ln -s ../../en/html/_static .; \
		cd "$$currentdir"; \
	done
	cp virtualenvwrapper.sh debian/virtualenvwrapper/etc/bash_completion.d/virtualenvwrapper
	chmod 0644 debian/virtualenvwrapper/etc/bash_completion.d/virtualenvwrapper
	dh_auto_install

override_dh_compress:
	dh_compress -i -X.rst -X.js -X.html

override_dh_installchangelogs:
	dh_installchangelogs docs/en/history.rst

%:
	dh --with python2,sphinxdoc $@
